<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.ssafit.model.dao.UserDao">

   <!-- 회원 가입 -->
   <insert id="insertUser" parameterType="User">
       INSERT INTO users (user_id, password, username, email)
       VALUES (#{userId}, #{password}, #{username}, #{email})
   </insert>
   
   <!-- 회원 정보 조회 -->
   <select id="selectUser" parameterType="string" resultType="User">
       SELECT user_id, username, email, created_at
       FROM users 
       WHERE user_id = #{userId}
   </select>
   
   <!-- 이메일로 회원 조회 -->
   <select id="selectUserByEmail" parameterType="string" resultType="User">
       SELECT user_id, username, email, created_at
       FROM users 
       WHERE email = #{email}
   </select>
   
   <!-- 회원 정보 수정 -->
   <update id="updateUser" parameterType="User">
       UPDATE users 
       SET username = #{username}, 
           email = #{email}
       WHERE user_id = #{userId}
   </update>
   
   <!-- 회원 삭제 -->
   <delete id="deleteUser" parameterType="string">
       DELETE FROM users 
       WHERE user_id = #{userId}
   </delete>
   
   <!-- 로그인 -->
   <select id="login" resultType="User">
       SELECT user_id, username, email, created_at
       FROM users 
       WHERE user_id = #{userId} 
       AND password = #{password}
   </select>
   
   <!-- 팔로워 목록 조회 -->
   <select id="selectFollowers" parameterType="string" resultType="string">
       SELECT follower_id 
       FROM follows 
       WHERE following_id = #{userId}
   </select>
   
   <!-- 팔로잉 목록 조회 -->
   <select id="selectFollowing" parameterType="string" resultType="string">
       SELECT following_id 
       FROM follows 
       WHERE follower_id = #{userId}
   </select>
   
   <!-- 팔로우 추가 -->
   <insert id="addFollow">
       INSERT INTO follows (follower_id, following_id) 
       VALUES (#{followerId}, #{followingId})
   </insert>
   
   <!-- 팔로우 취소 -->
   <delete id="removeFollow">
       DELETE FROM follows 
       WHERE follower_id = #{followerId} 
       AND following_id = #{followingId}
   </delete>

</mapper>